monthly <- read.csv('data/monthly.csv')
quarterly <- read.csv('data/quarterly.csv')
foot_mth_pred <- read.csv('data/predictions/SARIMAX/foot_mth.csv')
colnames(foot_mth_pred) <- c('data', 'Sells', 'low_ci', 'upp_ci')
foot_mth_pred['set'] <- 'Forecast'
foot_mth_pred['Sector'] <- 'Football'
casu_mth_pred <- read.csv('data/predictions/SARIMAX/casu_mth.csv')
colnames(casu_mth_pred) <- c('data', 'Sells', 'low_ci', 'upp_ci')
casu_mth_pred['set'] <- 'Forecast'
casu_mth_pred['Sector'] <- 'Casual'
fish_mth_pred <- read.csv('data/predictions/SARIMAX/fish_mth.csv')
colnames(fish_mth_pred) <- c('data', 'Sells', 'low_ci', 'upp_ci')
fish_mth_pred['set'] <- 'Forecast'
fish_mth_pred['Sector'] <- 'Fishing'
x <- monthly %>% gather(Football:Fishing, key='Sector', value='Sells')
x['set'] <- 'Real'
x['low_ci'] <- NA
x['upp_ci'] <- NA
x <- rbind(x, foot_mth_pred)
x <- rbind(x, casu_mth_pred)
x <- rbind(x, fish_mth_pred)
fc_colors = c('Real' = '#F0544F', 'Forecast' = '#7EB2DD')
g <- x %>%
mutate(data=as.POSIXct(data)) %>%
filter(data > as.POSIXct("2021-01-01")) %>%
ggplot(aes(x=data, y=Sells, color=set)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = low_ci, ymax = upp_ci), fill = "#7EB2DD", alpha = 0.2) +
facet_wrap(~Sector, ncol=1, scales = 'free_y')
get_theme(g, fc_colors)
# XGBoost
foot_mth_pred <- read.csv('data/predictions/XGBOOST/foot_mth.csv')
colnames(foot_mth_pred) <- c('data', 'Sells')
foot_mth_pred['set'] <- 'Forecast'
foot_mth_pred['Sector'] <- 'Football'
casu_mth_pred <- read.csv('data/predictions/XGBOOST/casu_mth.csv')
colnames(casu_mth_pred) <- c('data', 'Sells')
casu_mth_pred['set'] <- 'Forecast'
casu_mth_pred['Sector'] <- 'Casual'
fish_mth_pred <- read.csv('data/predictions/XGBOOST/fish_mth.csv')
colnames(fish_mth_pred) <- c('data', 'Sells')
fish_mth_pred['set'] <- 'Forecast'
fish_mth_pred['Sector'] <- 'Fishing'
x <- monthly %>% gather(Football:Fishing, key='Sector', value='Sells')
x['set'] <- 'Real'
x <- rbind(x, foot_mth_pred)
x <- rbind(x, casu_mth_pred)
x <- rbind(x, fish_mth_pred)
fc_colors = c('Real' = '#F0544F', 'Forecast' = '#7EB2DD')
g <- x %>%
mutate(data=as.POSIXct(data)) %>%
filter(data > as.POSIXct("2021-01-01")) %>%
ggplot(aes(x=data, y=Sells, color=set)) +
geom_line() +
geom_point() +
facet_wrap(~Sector, ncol=1, scales = 'free_y')
get_theme(g, fc_colors)
g <- foot_mth_ts %>% ggmonthplot() + geom_point()
get_theme(g)
g <- foot_mth_ts %>% ggmonthplot() + geom_point() + labs(y='Sales')
get_theme(g)
g <- x %>% gather(Football:Fishing, key='Sector', value='Total') %>%
mutate(data=as.POSIXct(data)) %>%
ggplot(aes(x=data, y=Total, color=Sector)) +
geom_line() +
labs(x='Date', y='Sales')
get_theme(g, colors)
# MM90
x <- read.csv('data/mm90.csv')
g <- x %>% gather(Football:Fishing, key='Sector', value='Total') %>%
mutate(data=as.POSIXct(data)) %>%
ggplot(aes(x=data, y=Total, color=Sector)) +
geom_line() +
labs(x='Date', y='Sales')
get_theme(g, colors)
ggsave('Rplots/mm90.png', width=1100, height=550, dpi=250, unit='px')
g <- foot_mth_ts %>% ggmonthplot() + geom_point() + labs(y='Sales')
get_theme(g)
g <- foot_mth_ts %>% ggmonthplot() + geom_point() + labs(y='Sales') + scale_color_manual(values=('blue'))
get_theme(g)
foot_mth_ts %>% ggmonthplot() + geom_point() + labs(y='Sales') + scale_color_manual(values=('blue'))
g <- foot_mth_ts %>% ggmonthplot(color='line') + geom_point() + labs(y='Sales') + scale_color_manual(values=('blue'))
get_theme(g)
g <- foot_mth_ts %>% ggmonthplot(color='line') + geom_point() + labs(y='Sales') + scale_color_manual(values=(line='blue'))
g <- foot_mth_ts %>% ggmonthplot() + geom_point() + labs(y='Sales') + scale_color_manual(values='blue')
get_theme(g)
g <- foot_mth_ts %>% ggmonthplot() + geom_point(size=3) + labs(y='Sales')
get_theme(g)
g <- foot_mth_ts %>% ggmonthplot() + geom_point(size=1) + labs(y='Sales')
get_theme(g)
g <- casu_mth_ts %>% ggmonthplot() + geom_point(size=1) + labs(y='Sales')
get_theme(g)
g <- fish_mth_ts %>% ggmonthplot() + geom_point(size=1) + labs(y='Sales')
get_theme(g)
g <- foot_mth_ts %>% ggmonthplot() + geom_point(size=1) + labs(y='Sales')
get_theme(g)
g <- casu_mth_ts %>% ggmonthplot() + geom_point(size=1) + labs(y='Sales')
get_theme(g)
g <- foot_mth_ts %>% ggmonthplot() + geom_point(size=1) + labs(y='Sales')
get_theme(g)
ggsave('Rplots/seas_foot.png', grid, width=1200, height=500, dpi=250, unit='px')
g <- foot_mth_ts %>% ggmonthplot() + geom_point(size=1) + labs(y='Sales')
get_theme(g)
ggsave('Rplots/seas_foot.png', width=1200, height=500, dpi=250, unit='px')
ggsave('Rplots/seas_foot.png', width=1000, height=500, dpi=250, unit='px')
g <- casu_mth_ts %>% ggmonthplot() + geom_point(size=1) + labs(y='Sales')
get_theme(g)
ggsave('Rplots/seas_casu.png', width=1000, height=500, dpi=250, unit='px')
g <- fish_mth_ts %>% ggmonthplot() + geom_point(size=1) + labs(y='Sales')
get_theme(g)
ggsave('Rplots/seas_fish.png', width=1000, height=500, dpi=250, unit='px')
mth_cor_matrix <- monthly %>% select(Football:Fishing) %>% cor()
cp2 <- ggcorrplot(mth_cor_matrix, lab = TRUE, colors = cor_colors, title = 'Monthly', type='lower') + theme(legend.position = "none")
cp2
cp2
ggsave('Rplots/mth_corr.png', grid, width=700, height=700, dpi=250, unit='px')
ggsave('Rplots/mth_corr.png', width=700, height=700, dpi=250, unit='px')
get_theme(cp2)
ggsave('Rplots/mth_corr.png', width=700, height=700, dpi=250, unit='px')
acf1 <- autoplot(acf(foot_wly_ts, lag=120))
acf2 <- autoplot(acf(casu_wly_ts, lag=120))
acf3 <- autoplot(acf(fish_wly_ts, lag=120))
pacf1 <- autoplot(pacf(foot_wly_ts, lag=120)) + labs(y='PACF')
pacf2 <- autoplot(pacf(casu_wly_ts, lag=120)) + labs(y='PACF')
pacf3 <- autoplot(pacf(fish_wly_ts, lag=120)) + labs(y='PACF')
grid <- grid.arrange(get_theme(acf1), get_theme(pacf1), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
grid <- grid.arrange(get_theme(acf4), get_theme(pacf4), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
acf4 <- autoplot(acf(diff(foot_mth_ts), lag=36)) + labs(title='')
acf5 <- autoplot(acf(diff(casu_mth_ts), lag=36)) + labs(title='')
acf6 <- autoplot(acf(diff(fish_mth_ts), lag=36)) + labs(title='')
pacf4 <- autoplot(pacf(diff(foot_mth_ts), lag=36)) + labs(y='PACF', title='')
pacf5 <- autoplot(pacf(diff(casu_mth_ts), lag=36)) + labs(y='PACF', title='')
pacf6 <- autoplot(pacf(diff(fish_mth_ts), lag=36)) + labs(y='PACF', title='')
grid <- grid.arrange(get_theme(acf4), get_theme(pacf4), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
grid <- grid.arrange(get_theme(acf4), get_theme(pacf4), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/foot_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
foot_mth_ts <- ts(monthly$Football, start=c(2016, 1, 31), end=c(2022, 12, 31), frequency=12)
casu_mth_ts <- ts(monthly$Casual, start=c(2016, 1, 31), end=c(2022, 12, 31), frequency=12)
fish_mth_ts <- ts(monthly$Fishing, start=c(2016, 1, 31), end=c(2022, 12, 31), frequency=12)
foot_qtr_ts <- ts(quarterly$Football, start=c(2016, 1, 31), end=c(2022, 12, 31), frequency=4)
casu_qtr_ts <- ts(quarterly$Casual, start=c(2016, 1, 31), end=c(2022, 12, 31), frequency=4)
fish_qtr_ts <- ts(quarterly$Fishing, start=c(2016, 1, 31), end=c(2022, 12, 31), frequency=4)
pacf1 <- autoplot(pacf(foot_wly_ts, lag=120)) + labs(y='PACF')
pacf2 <- autoplot(pacf(casu_wly_ts, lag=120)) + labs(y='PACF')
pacf3 <- autoplot(pacf(fish_wly_ts, lag=120)) + labs(y='PACF')
grid <- grid.arrange(get_theme(acf1), get_theme(pacf1), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
grid <- grid.arrange(get_theme(acf2), get_theme(pacf2), ncol=2)
title <- textGrob("Casual", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
grid <- grid.arrange(get_theme(acf3), get_theme(pacf3), ncol=2)
title <- textGrob("Fishing", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
acf4 <- autoplot(acf(diff(foot_mth_ts), lag=36)) + labs(title='')
acf5 <- autoplot(acf(diff(casu_mth_ts), lag=36)) + labs(title='')
acf6 <- autoplot(acf(diff(fish_mth_ts), lag=36)) + labs(title='')
pacf4 <- autoplot(pacf(diff(foot_mth_ts), lag=36)) + labs(y='PACF', title='')
pacf5 <- autoplot(pacf(diff(casu_mth_ts), lag=36)) + labs(y='PACF', title='')
pacf6 <- autoplot(pacf(diff(fish_mth_ts), lag=36)) + labs(y='PACF', title='')
grid <- grid.arrange(get_theme(acf4), get_theme(pacf4), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
acf4 <- acf(diff(foot_mth_ts), lag=36)
autoplot(acf_data) +
theme_bw() +
scale_x_continuous(
breaks = acf4$lag,
labels = acf4$lag
)
autoplot(acf4) +
theme_bw() +
scale_x_continuous(
breaks = acf4$lag,
labels = acf4$lag
)
autoplot(acf4) +
theme_bw() +
scale_x_continuous(
labels = acf4$lag
)
autoplot(acf4) +
theme_bw() +
scale_x_continuous(
labels = acf4$lag
)
acf4$lag
1:36
autoplot(acf4) +
theme_bw() +
scale_x_continuous(
breaks = 0:36,
labels = 0:36
)
autoplot(acf4) +
theme_bw() +
scale_x_continuous(
breaks = acf4$lag,
labels = 0:36
)
0:36 % 5
c(0:36) % 5
c(0:36)
c(0:36) / 2
c(0:36) // 5
c(0:36) %% 2
ifelse(c(0:36) %% 5 == 0, )
ifelse(c(0:36) %% 5 == 0, 0:36, '')
autoplot(acf4) +
theme_bw() +
scale_x_continuous(
breaks = acf4$lag,
labels = ifelse(c(0:36) %% 5 == 0, 0:36, '')
)
plot_acf <- function(acf_){
g <- autoplot(acf4) +
theme_bw() +
scale_x_continuous(
breaks = acf4$lag,
labels = ifelse(c(0:36) %% 5 == 0, 0:36, '')
)
return(get_theme(g))
}
plot_acf(acf4)
plot_acf <- function(acf_, k, title){
g <- autoplot(acf4) +
theme_bw() +
scale_x_continuous(
breaks = acf4$lag,
labels = ifelse(c(0:36) %% k == 0, 0:36, '')
)
return(get_theme(g))
}
plot_acf(acf4, 6, '')
plot_acf <- function(acf_, k, title){
g <- autoplot(acf4) +
theme_bw() +
scale_x_continuous(
breaks = acf4$lag,
labels = ifelse(c(0:36) %% k == 0, 0:36, '')
)
return(get_theme(g))
}
plot_acf(acf4, 6, '')
plot_acf <- function(acf_, k, title){
g <- autoplot(acf4) +
theme_bw() +
scale_x_continuous(
breaks = acf4$lag,
labels = ifelse(c(0:36) %% k == 0, 0:36, '')
) + labs(title=title)
return(get_theme(g))
}
plot_acf(acf4, 6, '')
plot_acf <- function(acf_, k, title){
g <- autoplot(acf4) +
theme_bw() +
scale_x_continuous(
breaks = acf4$lag,
labels = ifelse(c(0:36) %% k == 0, 0:36, '')
) + labs(title=title)
return(get_theme(g))
}
acf1 <- acf(foot_wly_ts, lag=120)
acf2 <- acf(casu_wly_ts, lag=120)
acf3 <- acf(fish_wly_ts, lag=120)
plot_acf <- function(acf_, k, title, ylab){
g <- autoplot(acf_) +
theme_bw() +
scale_x_continuous(
breaks = acf_$lag,
labels = ifelse(c(0:36) %% k == 0, 0:36, '')
) + labs(title=title, y=ylab)
return(get_theme(g))
}
acf1 <- acf(foot_wly_ts, lag=120)
acf2 <- acf(casu_wly_ts, lag=120)
acf3 <- acf(fish_wly_ts, lag=120)
pacf1 <- pacf(foot_wly_ts, lag=120)
pacf2 <- pacf(casu_wly_ts, lag=120)
pacf3 <- pacf(fish_wly_ts, lag=120)
grid <- grid.arrange(plot_acf(acf1, 4, '', 'ACF'), plot_acf(pacf1, 4, '', 'PACF'), ncol=2)
acf_
acf4
length(acf4$lag)
plot_acf <- function(acf_, k, title, ylab){
n <- length(acf_$lag)+1
g <- autoplot(acf_) +
theme_bw() +
scale_x_continuous(
breaks = acf_$lag,
labels = ifelse(c(0:n) %% k == 0, 0:n, '')
) + labs(title=title, y=ylab)
return(get_theme(g))
}
grid <- grid.arrange(plot_acf(acf1, 4, '', 'ACF'), plot_acf(pacf1, 4, '', 'PACF'), ncol=2)
plot_acf(acf1, 4, '', 'ACF')
ifelse(c(0:120) %% k == 0, 0:120, '')
ifelse(c(0:120) %% 4 == 0, 0:120, '')
acf1$lag
length(acf1$lag)
plot_acf <- function(acf_, k, title, ylab){
n <- length(acf_$lag)+1
g <- autoplot(acf_) +
theme_bw() +
scale_x_continuous(
breaks = acf_$lag,
labels = ifelse(c(0:n) %% k == 0, 0:n, '')
) + labs(title=title, y=ylab)
return(get_theme(g))
}
plot_acf <- function(acf_, k, title, ylab){
n <- length(acf_$lag)-1
g <- autoplot(acf_) +
theme_bw() +
scale_x_continuous(
breaks = acf_$lag,
labels = ifelse(c(0:n) %% k == 0, 0:n, '')
) + labs(title=title, y=ylab)
return(get_theme(g))
}
plot_acf <- function(acf_, k, title, ylab){
n <- length(acf_$lag)-1
g <- autoplot(acf_) +
theme_bw() +
scale_x_continuous(
breaks = acf_$lag,
labels = ifelse(c(0:n) %% k == 0, 0:n, '')
) + labs(title=title, y=ylab)
return(get_theme(g))
}
plot_acf(acf1, 4, '', 'ACF')
grid <- grid.arrange(plot_acf(acf1, 4, '', 'ACF'), plot_acf(pacf1, 4, '', 'PACF'), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
grid <- grid.arrange(plot_acf(acf1, 16, '', 'ACF'), plot_acf(pacf1, 16, '', 'PACF'), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
grid <- grid.arrange(plot_acf(acf1, 12, '', 'ACF'), plot_acf(pacf1, 12, '', 'PACF'), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/foot_wly_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf1, 12, '', 'ACF'), plot_acf(pacf1, 12, '', 'PACF'), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/foot_wly_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf2, 12, '', 'ACF'), plot_acf(pacf2, 12, '', 'PACF'), ncol=2)
title <- textGrob("Casual", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/casu_wly_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf3, 12, '', 'ACF'), plot_acf(pacf3, 12, '', 'PACF'), ncol=2)
title <- textGrob("Fishing", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/fish_wly_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
acf1 <- acf(diff(foot_wly_ts), lag=120)
acf2 <- acf(diff(casu_wly_ts), lag=120)
acf3 <- acf(diff(fish_wly_ts), lag=120)
pacf1 <- pacf(diff(foot_wly_ts), lag=120)
pacf2 <- pacf(diff(casu_wly_ts), lag=120)
pacf3 <- pacf(diff(fish_wly_ts), lag=120)
grid <- grid.arrange(plot_acf(acf1, 12, '', 'ACF'), plot_acf(pacf1, 12, '', 'PACF'), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/foot_wly_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf2, 12, '', 'ACF'), plot_acf(pacf2, 12, '', 'PACF'), ncol=2)
title <- textGrob("Casual", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/casu_wly_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf3, 12, '', 'ACF'), plot_acf(pacf3, 12, '', 'PACF'), ncol=2)
title <- textGrob("Fishing", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/fish_wly_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
acf4 <- acf(diff(foot_mth_ts), lag=36)
acf5 <- acf(diff(casu_mth_ts), lag=36)
acf6 <- acf(diff(fish_mth_ts), lag=36)
acf4 <- acf(diff(foot_mth_ts), lag=36)
acf5 <- acf(diff(casu_mth_ts), lag=36)
acf6 <- acf(diff(fish_mth_ts), lag=36)
pacf4 <- pacf(diff(foot_mth_ts), lag=36)
pacf5 <- pacf(diff(casu_mth_ts), lag=36)
pacf6 <- pacf(diff(fish_mth_ts), lag=36)
grid <- grid.arrange(plot_acf(acf4, 4, '', 'ACF'), plot_acf(pacf4, 4, '', 'PACF'), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/foot_mth_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf5, 4, '', 'ACF'), plot_acf(pacf5, 4, '', 'PACF'), ncol=2)
title <- textGrob("Casual", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/casu_mth_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf6, 4, '', 'ACF'), plot_acf(pacf6, 4, '', 'PACF'), ncol=2)
title <- textGrob("Fishing", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/fish_mth_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
acf7 <- acf(foot_qtr_ts, lag=12)
acf8 <- acf(casu_qtr_ts, lag=12)
acf9 <- acf(fish_qtr_ts, lag=12)
pacf7 <- pacf(foot_qtr_ts, lag=12)
pacf8 <- pacf(casu_qtr_ts, lag=12)
pacf9 <- pacf(fish_qtr_ts, lag=12)
grid <- grid.arrange(plot_acf(acf7, 1, '', 'ACF'), plot_acf(pacf7, 1, '', 'PACF'), ncol=2)
acf7 <- acf(foot_qtr_ts, lag=12)
acf8 <- acf(casu_qtr_ts, lag=12)
acf9 <- acf(fish_qtr_ts, lag=12)
pacf7 <- pacf(foot_qtr_ts, lag=12)
pacf8 <- pacf(casu_qtr_ts, lag=12)
pacf9 <- pacf(fish_qtr_ts, lag=12)
grid <- grid.arrange(plot_acf(acf7, 1, '', 'ACF'), plot_acf(pacf7, 1, '', 'PACF'), ncol=2)
title <- textGrob("Fishing", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
grid <- grid.arrange(plot_acf(acf7, 1, '', 'ACF'), plot_acf(pacf7, 1, '', 'PACF'), ncol=2)
title <- textGrob("Fishing", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/foot_qtr_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf8, 1, '', 'ACF'), plot_acf(pacf8, 1, '', 'PACF'), ncol=2)
title <- textGrob("Fishing", gp = gpar(fontsize = 14))
grid <- grid.arrange(plot_acf(acf7, 1, '', 'ACF'), plot_acf(pacf7, 1, '', 'PACF'), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/foot_qtr_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf8, 1, '', 'ACF'), plot_acf(pacf8, 1, '', 'PACF'), ncol=2)
title <- textGrob("Casual", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/casu_qtr_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf9, 1, '', 'ACF'), plot_acf(pacf9, 1, '', 'PACF'), ncol=2)
title <- textGrob("Fishing", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/fish_qtr_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
acf7 <- acf(diff(foot_qtr_ts), lag=12)
acf8 <- acf(diff(casu_qtr_ts), lag=12)
acf9 <- acf(diff(fish_qtr_ts), lag=12)
pacf7 <- pacf(diff(foot_qtr_ts), lag=12)
pacf8 <- pacf(diff(casu_qtr_ts), lag=12)
pacf9 <- pacf(diff(fish_qtr_ts), lag=12)
grid <- grid.arrange(plot_acf(acf7, 1, '', 'ACF'), plot_acf(pacf7, 1, '', 'PACF'), ncol=2)
title <- textGrob("Football", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/foot_qtr_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf8, 1, '', 'ACF'), plot_acf(pacf8, 1, '', 'PACF'), ncol=2)
title <- textGrob("Casual", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/casu_qtr_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
grid <- grid.arrange(plot_acf(acf9, 1, '', 'ACF'), plot_acf(pacf9, 1, '', 'PACF'), ncol=2)
title <- textGrob("Fishing", gp = gpar(fontsize = 14))
final_grid <- grid.arrange(title, grid, ncol = 1, heights = c(0.1, 0.9))
ggsave('Rplots/fish_qtr_correlog.png', final_grid, width=1500, height=700, dpi=250, unit='px')
# Plot predictions
# SARIMAX
weekly <- read.csv('data/weekly.csv')
monthly <- read.csv('data/monthly.csv')
quarterly <- read.csv('data/quarterly.csv')
foot_mth_pred <- read.csv('data/predictions/SARIMAX/foot_mth.csv')
colnames(foot_mth_pred) <- c('data', 'Sells', 'low_ci', 'upp_ci')
foot_mth_pred['set'] <- 'Forecast'
foot_mth_pred['Sector'] <- 'Football'
casu_mth_pred <- read.csv('data/predictions/SARIMAX/casu_mth.csv')
colnames(casu_mth_pred) <- c('data', 'Sells', 'low_ci', 'upp_ci')
casu_mth_pred['set'] <- 'Forecast'
casu_mth_pred['Sector'] <- 'Casual'
fish_mth_pred <- read.csv('data/predictions/SARIMAX/fish_mth.csv')
colnames(fish_mth_pred) <- c('data', 'Sells', 'low_ci', 'upp_ci')
fish_mth_pred['set'] <- 'Forecast'
fish_mth_pred['Sector'] <- 'Fishing'
x <- monthly %>% gather(Football:Fishing, key='Sector', value='Sells')
x['set'] <- 'Real'
x['low_ci'] <- NA
x['upp_ci'] <- NA
x <- rbind(x, foot_mth_pred)
x <- rbind(x, casu_mth_pred)
x <- rbind(x, fish_mth_pred)
fc_colors = c('Real' = '#F0544F', 'Forecast' = '#7EB2DD')
g <- x %>%
mutate(data=as.POSIXct(data)) %>%
filter(data > as.POSIXct("2021-01-01")) %>%
ggplot(aes(x=data, y=Sells, color=set)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = low_ci, ymax = upp_ci), fill = "#7EB2DD", alpha = 0.2) +
facet_wrap(~Sector, ncol=1, scales = 'free_y')
get_theme(g, fc_colors)
ggsave('Rplots/sarimax_mth.png', width=1500, height=1500, dpi=250, unit='px')
ggsave('Rplots/sarimax_mth.png', width=1500, height=1000, dpi=250, unit='px')
ggsave('Rplots/sarimax_mth.png', width=1200, height=800, dpi=250, unit='px')
g <- x %>%
mutate(data=as.POSIXct(data), Sector=as.factor(Sector, levels=('Football', 'Casual', 'Fishing'))) %>%
g <- x %>%
mutate(data=as.POSIXct(data), Sector=as.factor(Sector, levels=c('Football', 'Casual', 'Fishing'))) %>%
filter(data > as.POSIXct("2021-01-01")) %>%
ggplot(aes(x=data, y=Sells, color=set)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = low_ci, ymax = upp_ci), fill = "#7EB2DD", alpha = 0.2) +
facet_wrap(~Sector, ncol=1, scales = 'free_y')
g <- x %>%
mutate(data=as.POSIXct(data), Sector=factor(Sector, levels=c('Football', 'Casual', 'Fishing'))) %>%
filter(data > as.POSIXct("2021-01-01")) %>%
ggplot(aes(x=data, y=Sells, color=set)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = low_ci, ymax = upp_ci), fill = "#7EB2DD", alpha = 0.2) +
facet_wrap(~Sector, ncol=1, scales = 'free_y')
get_theme(g, fc_colors)
ggsave('Rplots/sarimax_mth.png', width=1200, height=800, dpi=250, unit='px')
ggsave('Rplots/sarimax_mth.png', width=1200, height=900, dpi=250, unit='px')
ggsave('Rplots/sarimax_mth.png', width=1200, height=1000, dpi=250, unit='px')
